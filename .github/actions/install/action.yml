name: ðŸ’¿Install
description: Install app
inputs:
  os-name:
    required: true
    description: OS to run on
  python-version:
    required: true
    description: Python version to install
  pillow-version:
    required: true
    description: Pillow version to install

#########
# actions
#########
# actions/checkout@v3.5.3
# actions/setup-python@v4.6.1
# actions/upload-artifact@v3.1.2

runs:
  using: "composite"
  steps:
    # install python
    - name: ðŸ’¿Install Python
      uses: actions/setup-python@v4.6.1
      with:
        python-version: ${{ inputs.python-version }}
    # install modules via pip
    - name: ðŸ’¿Install Modules
      shell: bash
      env:
        OS_NAME: ${{ inputs.os-name }}
      run: |
        echo "Install Modules"
        python ./resources/ci/common/get_pipline.py
    # print pipline
    - name: PipLine
      shell: bash
      run: |
        echo "PipLine"
        cat ./resources/user/meta/manifests/pipline.txt
    # upload pipline
    - name: ðŸ”¼Upload PipLine
      uses: actions/upload-artifact@v3.1.2
      with:
        name: pipline-${{ inputs.os-name }}-${{ inputs.python-version }}-${{ inputs.pillow-version }}
        path: ./resources/user/meta/manifests
    # install pillow (macos)
    - name: ðŸ’¿Install Pillow (MacOS)
      shell: bash
      run: |
        python -m pip install pillow==${{ inputs.pillow-version }} --global-option="--disable-zlib"
      if: contains(inputs.os-name, 'macos')
    # install pillow
    - name: ðŸ’¿Install Pillow (!MacOS)
      shell: bash
      run: |
        python -m pip install pillow==${{ inputs.pillow-version }}
      if: contains(inputs.os-name, 'macos') != true
